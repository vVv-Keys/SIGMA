title: Suspicious Msiexec Remote Install
id: 9f2b6d54-3f79-4b64-9c65-ec9fd2d65e9e
status: experimental
description: Detects msiexec.exe downloading and executing a remote MSI from a URL or network share via /i, /x, /package, or /quiet switches, which may indicate abuse for remote code execution.
author: vVv-Keys
date: 2026/01/17
references:
  - https://attack.mitre.org/techniques/T1218/007/
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/msiexec
logsource:
  product: windows
  category: process_creation
detection:
  selection_image:
    Image|endswith:
      - '\\msiexec.exe'
  selection_commandline:
    CommandLine|contains:
      - 'http://'
      - 'https://'
      - '\\\\'
  selection_switches:
    CommandLine|contains:
      - '/i'
      - '/x'
      - '/package'
      - '/q'
      - '/quiet'
  condition: selection_image and (selection_commandline or selection_switches)
falsepositives:
  - Legitimate remote MSI installations by administrators
level: medium
tags:
  - attack.defense_evasion
  - attack.execution
  - attack.t1218.007
