title: Suspicious Regsvr32 Remote COM Script Execution
id: 8c5fb72e-2652-4de9-91ba-7288a59e8020
status: experimental
description: Detects regsvr32.exe executing a remote scriptlet or COM script from a remote location using scrobj.dll and /i: flag, which may indicate code execution via regsvr32.
author: vVv-Keys
date: 2026/01/17
references:
  - https://attack.mitre.org/techniques/T1117/
logsource:
  product: windows
  category: process_creation
detection:
  selection_image:
    Image|endswith:
      - '\\regsvr32.exe'
  selection_payload:
    CommandLine|contains:
      - 'scrobj.dll'
  selection_url:
    CommandLine|contains:
      - 'http://'
      - 'https://'
      - '\\\\'
  selection_flags:
    CommandLine|contains:
      - '/i:'
      - '/s'
      - '/n'
  condition: selection_image and ((selection_payload and selection_url) or selection_flags)
falsepositives:
  - Legitimate regsvr32 usage to register COM components or ActiveX controls with remote resources
level: high
tags:
  - attack.defense_evasion
  - attack.t1117
  - attack.execution
