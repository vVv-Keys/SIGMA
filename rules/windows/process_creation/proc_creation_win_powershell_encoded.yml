title: Suspicious PowerShell Encoded Command Execution
id: d1fc7d47-75ef-4d93-b41b-e6f14c6dc123
status: experimental
description: Detects execution of PowerShell with encoded command arguments (e.g., -EncodedCommand or -enc), which may indicate obfuscated malicious activity.
author: vVv-Keys
date: 2026/01/17
references:
  - https://attack.mitre.org/techniques/T1059/001/
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_powershell_security
logsource:
  product: windows
  category: process_creation
detection:
  selection_image:
    Image|endswith:
      - '\powershell.exe'
      - '\powershell_ise.exe'
      - '\pwsh.exe'
  selection_encoded:
    CommandLine|contains:
      - '-enc'
      - '-EncodedCommand'
      - '-e '
  selection_obfuscation:
    CommandLine|contains:
      - 'IEX'
      - 'Invoke-Expression'
      - 'FromBase64String'
  condition: selection_image and (selection_encoded or selection_obfuscation)
falsepositives:
  - Administrative scripts that legitimately use encoded commands
  - PowerShell remoting or legitimate encoded tasks
level: high
tags:
  - attack.execution
  - attack.t1059.001
  - attack.obfuscation
